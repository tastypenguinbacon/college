.ORG 0
	SJMP	INIT
.ORG 0x0B
	SJMP T0_ISR
.ORG 30h
INIT:	MOV TMOD, #0x1
	MOV IE, #0X82
	MOV TH0, #60
	MOV TL0, #176
	SETB TR0
	MOV DPTR, #LED_TABLE
	MOV R0, #0
	MOV R1, #0
	MOV R2, #0
	MOV R3, #0
	MOV R4, #201
	MOV R5, #0
	SJMP $
	
T0_ISR:
	PUSH A
	CLR TR0
	MOV TH0, #60
	MOV TL0, #176
	SETB TR0
	DJNZ R4, NEXT
	MOV R4, #201
	CALL UPDATE_COUNTER
NEXT:	CALL CHANGE_LED
	POP A
	RETI

UPDATE_COUNTER:
	MOV R6, #1
	MOV A, R0
	ACALL GET_MODULO_TEN
	MOV R0, A
	MOV A, R1
	ACALL GET_MODULO_SIX
	MOV R1, A
	MOV A, R2
	ACALL GET_MODULO_TEN
	MOV R2, A
	MOV A, R3
	ACALL GET_MODULO_SIX
	MOV R3, A
	RET

GET_MODULO_TEN:
	CJNE R6, #1, RETURN_MODULO_TEN
	MOV R6, #0
	INC A
	CJNE A, #10, RETURN_MODULO_TEN
	MOV A, #0
	MOV R6, #1
RETURN_MODULO_TEN:
	RET

GET_MODULO_SIX:
	CJNE R6, #1, RETURN_MODULO_SIX
	MOV R6, #0
	INC A
	CJNE A, #6, RETURN_MODULO_SIX
	MOV A, #0
	MOV R6, #1
RETURN_MODULO_SIX:
	RET	
	
CHANGE_LED:
	MOV P0, #0xFF
	CJNE R5, #3, NOT3
	MOV P1, #8
	MOV A, R0
	MOVC A, @A+DPTR
	MOV P0, A
	MOV R5, #2
	RET
NOT3:	CJNE R5, #2, NOT2
	MOV P1, #8
	MOV A, R1
	MOVC A, @A+DPTR
	MOV P0, A
	MOV R5, #1
	RET
NOT2:	CJNE R5, #1, NOT1
	MOV P1, #2
	MOV A, R2
	MOVC A, @A+DPTR
	MOV P0, A
	MOV R5, #0
	RET
NOT1:	MOV R5, #3
	MOV P1, #1
	MOV A, R3
	MOVC A, @A+DPTR
	MOV P0, A
	MOV R5, #3
	RET
	
LED_TABLE:
	DB 0xc0
	DB 0xf9
	DB 0xa4
	DB 0xa4
	DB 0xb0
	DB 0x99
	DB 0x92
	DB 0x92
	DB 0x82
	DB 0xf8
	DB 0x80
	DB 0x90
END
